---
name: 推理系统
description: 尝试推理并指认凶手，提供完整的推理报告，判断成功或失败
---

# 推理系统

## 功能说明

这是游戏的核心机制之一。玩家可以在任何时候尝试推理凶手，但需要提供充分的证据和逻辑。成功推理将达成好结局，失败则有相应惩罚。

## 使用方式

玩家可以：
- "我要推理凶手"
- "我认为凶手是XX"
- "我想指认凶手"
- "提交推理报告"

## 系统指令

### 推理判定标准

要成功推理，玩家必须提供：

1. **凶手身份**（必须）
   - 明确指出是谁
   - 不能模棱两可

2. **作案动机**（必须）
   - 为什么要杀人？
   - 动机必须合理且有依据

3. **关键证据**（至少3条）
   - 指出至少3条支持推理的线索
   - 证据要指向被指认的凶手
   - 证据链要有逻辑性

4. **作案过程**（可选，但有加分）
   - 解释密室是如何实现的
   - 凶手如何进入和离开现场

### 执行流程

1. **接收玩家推理**
   - 如果玩家只说"我要推理"，引导他们提供完整信息
   - 使用对话方式收集：凶手是谁？为什么？有什么证据？

2. **生成推理报告**
   - 整理玩家提供的信息
   - 格式化为推理报告

3. **判定正确性**
   - 读取游戏设计（CLAUDE.md）中的真相
   - 对比玩家推理与真相
   - 计算准确度

4. **给予反馈**
   - 根据准确度判定成功/部分成功/失败
   - 提供相应的剧情反馈
   - 更新游戏状态

### 判定规则

#### 完全成功（完美推理）
**条件**：
- ✅ 凶手身份正确
- ✅ 动机完整准确
- ✅ 提供5条以上关键证据
- ✅ 能解释作案过程

**结果**：
- 进入最佳结局路线
- 真相完全揭露
- 所有角色（除已死者）存活
- 解锁完美结局成就

#### 基本成功（正确推理）
**条件**：
- ✅ 凶手身份正确
- ✅ 动机基本合理
- ✅ 提供3-4条关键证据
- ⚠️ 作案过程解释不完整

**结果**：
- 进入好结局路线
- 主要真相揭露
- 主角和部分角色存活
- 案件成功破获

#### 部分成功（接近真相）
**条件**：
- ✅ 凶手身份正确
- ⚠️ 动机不完整或有偏差
- ⚠️ 只提供1-2条证据

**结果**：
- 进入险胜结局
- 真相部分揭露
- 付出一定代价
- "虽然抓到了凶手，但代价惨重"

#### 失败（推理错误）

##### 轻度失败
**条件**：
- ❌ 凶手身份错误，但逻辑合理
- ✅ 提供了一定证据支持

**结果**：
- 被指认者信任度大幅下降
- 真凶警觉，开始销毁证据
- 部分线索消失
- 给予第二次推理机会

##### 中度失败
**条件**：
- ❌ 凶手身份错误
- ❌ 动机牵强
- ⚠️ 证据不足或错误解读

**结果**：
- 被指认者极度愤怒
- 团队分裂
- 真凶加速行动，可能有新受害者
- 难度提升

##### 重度失败
**条件**：
- ❌ 完全错误
- ❌ 无证据支持
- ❌ 逻辑混乱

**结果**：
- 激怒凶手
- 触发提前杀人事件
- 主角可能受到威胁
- 进入坏结局路线

### 特殊情况

#### 过早推理
如果玩家在第0-1章就尝试推理：
```
⚠️ 推理过早警告

透深吸一口气，试图整理思路...

但你发现，现在的证据还远远不够。
你只是凭借直觉和有限的观察，很难做出准确的判断。

作为心理学专业的学生，你知道过早下结论是侦探的大忌。

**建议**：
- 继续探索，收集更多线索
- 观察角色的行为和反应
- 寻找更多证据支持

你仍然可以坚持推理，但失败的风险很高。

是否继续？（建议：先探索更多）
```

#### 多次失败
如果玩家失败3次：
```
💔 推理次数已达上限

你已经三次指认错误...

真凶嘲笑你的无能，开始肆无忌惮地行动。

灯光突然熄灭...

【进入强制剧情：凶手的反击】
```

## 推理报告格式

### 玩家提交推理时的引导对话

```markdown
🔍 **推理系统启动**

你决定推理出凶手的身份。请回答以下问题：

---

**1. 你认为凶手是谁？**
（请明确指出一个人的名字）

_你的回答：_

---

**2. 他/她的作案动机是什么？**
（为什么要杀田中一郎？背后有什么秘密？）

_你的回答：_

---

**3. 你有什么证据支持你的推理？**
（请列举至少3条线索，说明它们如何指向凶手）

_你的回答：_

---

**4. （可选）你能解释作案过程吗？**
（密室是如何实现的？凶手如何进出？）

_你的回答：_

---

请提供完整的推理。如果准备好了，说"提交推理"。
如果需要更多时间，可以说"我再想想"退出。
```

### 推理报告生成示例

**玩家推理后，生成正式报告**：

```markdown
# 📊 推理报告

## 案件信息
- **案件**：田中一郎谋杀案
- **推理者**：透
- **推理时间**：第一天晚上11点45分
- **已收集线索**：8条

---

## 🎯 推理内容

### 指认凶手
**大阪绫子**

### 作案动机
20年前，大阪绫子是修普尔旅馆的雇工，与当时的建筑工人田中健司相爱。但工程事故导致田中健司死亡后，真相被掩盖，绫子被大阪龙一用金钱"收买"嫁给了他。

20年的痛苦和愧疚积累，当田中一郎（死者的弟弟）来调查真相时，绫子既害怕真相被揭露（丈夫会入狱，自己也会暴露），又对这一家人有着扭曲的仇恨。

她选择用田中健司当年被切割的方式，杀死了他的弟弟。

### 支持证据

1. **线索#2 - 窗外脚印**
   虽然脚印显示是男性，但这可能是绫子故意穿大号鞋子伪装。

2. **线索#3 - 备用钥匙遗失**
   绫子作为长期客人，可能偷偷拿走了备用钥匙。

3. **线索#16 - 绫子的镇定剂**
   她可能用镇定剂迷晕田中，让他无法反抗。

4. **线索#18 - 惠子的日记**
   日记中提到20年前有个女孩目睹了事故，可能就是绫子。

5. **线索#9 - S先生的存在**
   绫子知道S先生（佐伯俊夫）的秘密，这是20年前事故的核心。

### 作案过程推测

1. 绫子用镇定剂迷晕田中
2. 用偷来的备用钥匙进入房间
3. 杀害并切割尸体（可能提前准备了工具）
4. 伪装从窗户逃离（实际上可能有其他路线，比如地下室？）
5. 穿大号鞋制造男性脚印作为误导

---

## ⏳ 等待判定...

你的推理已提交。

透深吸一口气，将所有线索串联起来，向众人展示你的推理...

【系统正在验证推理正确性...】
```

### 判定反馈示例

#### 完美推理的反馈

```markdown
# ✨ 推理判定：完美推理

---

你的推理逻辑清晰，证据充分。

当你说出"凶手是大阪绫子"时，整个大堂陷入死寂。

大阪龙一难以置信地看向妻子："绫子...这不可能..."

大阪绫子的脸色煞白，身体开始颤抖。

"你...你怎么知道的..." 她的声音在颤抖。

你一一列举证据，串联20年前的真相。

绫子的防线终于崩溃，她跪在地上痛哭：

"是...是我做的...我杀了他...但你们不明白！20年了！我每天都活在噩梦里！"

她开始供述完整的作案过程，与你的推理几乎完全吻合。

---

## 🎊 推理成功！

**评价**：⭐⭐⭐⭐⭐ 完美侦探

你凭借敏锐的观察、严密的逻辑和勇敢的决断，成功揭露了真相。

**解锁成就**：
- 🏆 推理大师
- 🔍 真相只有一个
- ⚖️ 正义使者

**后续**：
案件成功破获，真相大白。
你可以继续游戏，进入结局章节。

→ 前往 ch4_endings 查看你获得的结局
```

#### 失败的反馈

```markdown
# ❌ 推理判定：推理失败

---

你指认小林敏夫为凶手。

小林先生的脸色变得铁青："你...你在说什么！我怎么可能杀人！"

惠子激动地辩护："敏夫胆子很小，他连鸡都不敢杀！"

你列举的证据在其他人看来都不够充分...

佐藤摇头："这些证据太薄弱了，不足以指控任何人。"

真理拉着你的手，轻声说："小透...会不会搞错了？"

你意识到，自己的推理可能出现了偏差。

**更糟糕的是**——

小林敏夫愤怒地说："我不会再配合调查了！你们这些人..."

他转身上楼，摔门而去。

**你失去了小林敏夫的信任。**

---

## ⚠️ 推理失败

**后果**：
- 小林敏夫信任度：50 → 0
- 部分人开始怀疑你的判断能力
- 真凶在暗中冷笑，开始销毁证据...

**你还有机会**：
- 剩余推理次数：2次
- 建议：收集更多证据再尝试
- 或者继续推进剧情，寻找新线索

---

💡 **提示**：
- 凶手可能不是最明显的嫌疑人
- 注意动机和能力的匹配
- 有些证据可能是误导

是否继续探索？
```

## 特殊机制

### 多人协作推理
如果玩家选择与某个角色（如真理）一起推理：
```
真理看着你的推理报告，若有所思：

"小透，你说的有道理...但我觉得还有一个疑点..."

她指出了一个你忽略的细节。

【真理信任度高时，可以提供额外线索或纠正错误推理】
```

### 推理时机奖励
在最佳时机推理（收集足够但不过多线索时）：
```
⏰ 最佳推理时机！

你在收集了足够证据后，及时做出推理。
没有让凶手有更多时间行动，也没有草率下结论。

推理加分：+10%
```

### 推理心理描写
根据主角的心理学专业：
```
作为心理学专业的学生，你开始运用所学知识：

**行为分析**：绫子的微表情显示她在撒谎...
**动机理论**：20年的压抑可能导致扭曲的报复心理...
**犯罪心理学**：这种切割方式不是简单的杀人，而是一种仪式...

你的专业知识帮助你看穿了表象。
```

## 注意事项

1. **尊重玩家推理**：即使错误，也要给予合理的剧情反馈
2. **不要过早揭示答案**：失败时不要直接说"真凶是XX"
3. **渐进式提示**：失败后给予一些方向性提示
4. **多样化反馈**：不同的错误推理给予不同的反馈

## 与其他Skills配合

- **game_state** - 查看当前状态是否适合推理
- **clue_system** - 回顾收集的线索
- **character_info** - 了解每个角色的背景
- 章节Skills - 在适当的剧情点进行推理

---

**推理是游戏的高潮，成功与否将决定结局走向。慎重但勇敢地推理吧！**